window.analytics_ow=window.analytics_ow||{},window.analytics_ow.personalisation=window.analytics_ow.personalisation||{},window.analytics_ow.personalisation.globalvars=window.analytics_ow.personalisation.globalvars||{},window.analytics_ow.personalisation.globalvars.firedCampaign=window.analytics_ow.personalisation.globalvars.firedCampaign||{},window.analytics_ow.personalisation.func=window.analytics_ow.personalisation.func||{},window.analytics_ow.personalisation.templatecodes=window.analytics_ow.personalisation.templatecodes||{},window.analytics_ow.personalisation.func.find_all_by_key=(e,t)=>{if(e)return Object.entries(e).reduce(((e,[a,n],o)=>a===t?e.concat(n):"object"==typeof n&&"gtm.elementVisibility"!==n?.event?e.concat(window.analytics_ow.personalisation.func.find_all_by_key(n,t)):e),[])},window.analytics_ow.personalisation.func.find_value_by_event=(e,t,a)=>{if("object"==typeof e&&e.length>0)for(let n=0;n<e.length;n++)if(e[n].event===t)return analytics_ow.personalisation.func.find_all_by_key(e[n],a)[0]},window.analytics_ow.personalisation.func.setLocales=()=>{const{find_all_by_key:e}=window.analytics_ow.personalisation.func,{globalvars:t}=window.analytics_ow.personalisation;["market","language"].forEach((a=>{t[a]=e(dataLayer_ow,a)[0]}))},window.analytics_ow.personalisation.func.setVehicleInformation=()=>{const{find_all_by_key:e}=window.analytics_ow.personalisation.func,{globalvars:t}=window.analytics_ow.personalisation;["baumusterId","modelCode"].forEach((a=>{t[a.toLocaleLowerCase().replace("baumusterid","bm")]=e(dataLayer_ow,a)[0]}))},window.analytics_ow.personalisation.func.localStorage_check=()=>{const e=Date.now();Object.keys(localStorage).forEach((t=>{if(t.includes("target_")){const a=JSON.parse(localStorage.getItem(t));a&&a.expiration&&a.timestamp&&e>a.timestamp+1e3*a.expiration*60*60*24&&localStorage.removeItem(t)}}))},window.analytics_ow.personalisation.func.getStorageConsent=()=>{if(window.location.hostname.includes("antarctica")||"www.mercedes-benz.com.mx"===window.location.hostname)return!0;{const e=JSON.parse(localStorage.getItem("cmp_consents"))||{};return e.Personsalization_Component||e.Personalization_Component||false}},window.analytics_ow.personalisation.func.localStorage_set=(e,t,a=120)=>!!analytics_ow.personalisation.func.getStorageConsent()&&((t="string"==typeof t?JSON.parse(t):t).timestamp=t.timestamp||Date.now(),t.expiration=t.expiration||a,localStorage.setItem(e,JSON.stringify(t)),!0),window.analytics_ow.personalisation.func.sessionstorage_set=(e,t)=>!!(analytics_ow.personalisation.func.getStorageConsent()&&e&&t)&&(sessionStorage.setItem(e,"object"==typeof t?JSON.stringify(t):t),!0),window.analytics_ow.personalisation.func.check_storages=()=>{analytics_ow.personalisation.func.getStorageConsent()||setTimeout((()=>{["localStorage","sessionStorage"].forEach((e=>{let t=window[e];Object.keys(t).forEach((e=>{e.startsWith("target_")&&t.removeItem(e)}))}))}),1500)},analytics_ow.personalisation.func.getVMDSData_modelspecific=async(e,t=!1)=>{const a=e;let n=!1;if(!e.includes("-class")&&!t)try{if(!(e=await analytics_ow.personalisation.func.getVMDSData_modelmapping(e,!0)))return!1;e=e.classIds.classId,n=!0}catch(e){return console.log(`Error in getting VMDS data: ${e}`),!1}try{analytics_ow.personalisation.func.setLocales();const t=await fetch("https://api.oneweb.mercedes-benz.com/vmds-api/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\n            query classBodytypeVehicles($market: String!, $language: String!, $filter: String!) {\n              classBodytypeVehicles(market: $market, language: $language, filter: { classBodytype: { classId: $filter } }) {\n                 ccsClassId\n        classId\n        className\n        bodytypes {\n            models {\n                bm4\n                modelSeries\n                name\n                vehicles {\n                    images {\n                        cutouts {\n                            extraLarge\n                            large\n                            medium\n                            small\n                        }\n                        stage\n                    }\n                    subBrands\n                }\n                availableSubBrandsSets\n            }\n            bodytypeGroupId\n            bodytypeName\n            bodytypeId\n            ccsBodytypeId\n                }\n              }\n            }\n          ",variables:{market:analytics_ow.personalisation.globalvars.market,language:analytics_ow.personalisation.globalvars.language,filter:e}})}),{data:o}=await t.json();if(n){const e=analytics_ow.personalisation.func.vans_modelseries_mapping(a);let t=o.classBodytypeVehicles[0]?.bodytypes.flatMap((e=>e.models)).find((t=>t?.modelSeries?.toLowerCase()===a.toLowerCase()||t?.modelSeries?.toLowerCase()===a.toLowerCase()+"-fl"||t?.modelSeries?.toLowerCase()===a.toLowerCase().replace("-fl","")||t?.modelSeries?.toLowerCase()===e?.newModelSeries.toLowerCase()||t?.modelSeries?.toLowerCase()===e?.currentModelSeries.toLowerCase()));return t||!1}return o.classBodytypeVehicles}catch(e){return console.log(`Error in calling the API: ${e}`),!1}},analytics_ow.personalisation.func.getVMDSData_modelmapping=async(e,t)=>{const a=analytics_ow.personalisation.func.vans_modelseries_mapping(e);let n=window.analytics_ow.personalisation.vehiclemapping;if(!n)try{const e=await fetch("https://api.oneweb.mercedes-benz.com/vmds-api/v1/vehicle-data-ids"),t=await e.json();window.analytics_ow.personalisation.vehiclemapping=t,n=t}catch(e){return console.log(`Error in calling the api: ${e}`),!1}const o=n.find((t=>t.bm4===e||t.modelSeries.toLowerCase()===e.toLowerCase()||t.modelSeries.toLowerCase()===a?.newModelSeries.toLowerCase()||t.modelSeries.toLowerCase()===a?.currentModelSeries.toLowerCase()));return!!o&&(t?o:e===o.bm4?o.modelSeries:o.bm4)},analytics_ow.personalisation.func.getVehicleDeeplinks=async()=>{analytics_ow.personalisation.func.setLocales();const{market:e,language:t}=analytics_ow.personalisation.globalvars,a=`target_vehicle_deeplinks_${t}`;if(sessionStorage[a])return!0;if(e&&t)try{const n=`https://api.oneweb.mercedes-benz.com/vehicle-deeplinks-api/v1/deeplinks/${e}/${t}/model-series`,o=await fetch(n);if(!o.ok)throw new Error(`Error in calling the API: ${o.status}`);const i=await o.json();return window.analytics_ow.personalisation.func.sessionstorage_set(a,i),!0}catch(e){return console.error(`Error in calling the API: ${e}`),!1}},analytics_ow.personalisation.func.impressionTracking=(e,t,a)=>{const{type:n,campaign:o,format:i,experience:s,vehicle:r,trigger:l}=e;let c=t.trackingBlock?console.log:dataLayer_ow.push;n&&o&&i&&s&&""!==n&&""!==o&&""!==i&&""!==s||(console.log("Impression Tracking: Not all needed variables are set"),c=console.log),c({event:"click",eventDetail:{category:"impression",action:"Target",label:a,target:{experience:`${n}|${o}|${i}|${s}`,vehicle:r,trigger:l}},application:{id:"target",parentApplicationId:"aem"}})},analytics_ow.personalisation.func.clickTracking=(e,t,a,n=!1)=>{const{type:o,campaign:i,format:s,experience:r,vehicle:l,trigger:c}=t;let d=a.trackingBlock?console.log:dataLayer_ow.push,p="unspecified";(n||e).addEventListener("click",(a=>{var g=n?n.querySelector(e):e;g.classList.forEach((e=>{e.includes("primary")||"primary"===g.getAttribute("variant")?p="primary":e.includes("secondary")||e.includes("wb-link")||"secondary"===g.getAttribute("variant")?p="secondary":e.includes("tertiary")&&(p="tertiary")}));var m=!!n&&n.querySelector(e);if(0==n||a.target==m){let n=a.target.textContent.toLowerCase().trim().replace(/\s/g,"_").replace(".","");"offer-teaser"===t.format&&"home-ml-recommendations"===t.campaign&&(p=document.querySelector('[data-component-name="sccs-emh-offer-teaser"]')?.querySelector("wb7-pagination, .wb-pagination")?document.querySelector('[data-component-name="sccs-emh-offer-teaser"]')?.querySelector("wb7-pagination, .wb-pagination").getAttribute("current-page"):Array.from(document.querySelector('[data-component-name="sccs-emh-offer-teaser"]').querySelectorAll("a:not(.wb-button--primary")).indexOf(e)+1),o&&i&&s&&r&&""!==o&&""!==i&&""!==s&&""!==r||(console.log("Click Tracking: Not all needed variables are set"),d=console.log),d({event:"click",eventDetail:{category:"click",action:"Target",label:`${p}_${n}`,target:{experience:`${o}|${i}|${s}|${r}`,vehicle:l,trigger:c}},application:{id:"target",parentApplicationId:"aem"}})}}))},analytics_ow.personalisation.func.closeTracking=(e,t,a)=>{const{type:n,campaign:o,format:i,experience:s,vehicle:r,trigger:l}=e,{experience:c}=a;dataLayer_ow.push({event:"click",eventDetail:{category:"click",action:"Target",label:t,target:{experience:`${n}|${o}|${i}|${s}`,vehicle:r,trigger:l}},application:{id:"target",parentApplicationId:"aem"}});const d="true"!==sessionStorage.sendEvent_disable_test,p=!window.location.search.includes("evergageTestMessages");if(d&&p){const e={experienceId:c,stat:"Dismissal",control:"control"===s};Evergage.sendStat({campaignStats:[e]}),Evergage.sendEvent({action:`${o} - dismissal`})}else console.log(`Evergage Action: ${o} - dismissal`)},analytics_ow.personalisation.func.sendEvergageData=(e,t,a,n,o=!1)=>{let i=!1;"Control"===e.userGroup&&(i=!0);const s={experienceId:e.experience,stat:a,control:i};if("true"===sessionStorage.sendEvent_disable_test||window.location.search.includes("evergageTestMessages")||Evergage.sendStat({campaignStats:[s]}),"Impression"===a)"true"===sessionStorage.sendEvent_disable_test||window.location.search.includes("evergageTestMessages")?console.log(`Evergage Action: ${t.campaign} - impression`):Evergage.sendEvent({action:`${t.campaign} - impression`});else{(o||n).addEventListener("click",(function(e){"true"===sessionStorage.sendEvent_disable_test||window.location.search.includes("evergageTestMessages")?console.log(`Evergage Action: ${t.campaign} - click`):Evergage.sendEvent({action:`${t.campaign} - click`})}))}},analytics_ow.personalisation.func.stage_update=e=>{const t=document.querySelector("owc-stage:not([data-aem-targeting-hidden-initially])");if(!t)return;const a=analytics_ow.personalisation.func.getJSONData(t.getAttribute("component-id"))||"{}";e.cta={ctaDisplayMethod:"manual"};const n={...a,...e};window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA").then((e=>{e.addPersonalisationData({componentId:t.getAttribute("component-id"),personalisationData:n})}))},analytics_ow.personalisation.func.simpleteaser_update=(e,t,a,n,o,i,s,r,l,c)=>{const d=Array.from(document.querySelectorAll("owc-simple-teaser")),p=[`[data-aem-targeting-use-case="${t}"]`,l&&`[data-aem-targeting-use-case-variant="${l}"]`,c&&`[data-aem-targeting-vehicle="${c}"]`].filter(Boolean).join(""),g=d.find((e=>!e.classList.contains("aem--is-hidden")&&(e.shadowRoot.querySelector(p)||e.querySelector(p))));if(g){let d=g.shadowRoot.querySelector(p)||g.querySelector(p);if(e)return d;{let e=analytics_ow.personalisation.func.getJSONData(d.getAttribute("component-id"))||"{}";const m={...e,headline:a||e.headline,copy:n||e.copy,image:o||e.image,links:i||e.links,tags:s||e.tags,bullets:r||e.bullets};m.personalization={hidden:"false",targetCampaign:t,targetUseCaseVariant:l,targetVehicle:c},window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA").then((e=>{e.addPersonalisationData({componentId:d.getAttribute("component-id"),personalisationData:m}),d.classList.remove("aem--is-hidden");window.top.seamlessStore.initializeStore().getConnectionDispatchers("OWC_PERSONALISATION_DATA").then((e=>{"function"==typeof e.addItemsToShow&&(e.addItemsToShow({componentId:g.getAttribute("component-id"),itemsToShow:[d.getAttribute("component-id")]}),d=g.shadowRoot.querySelector(p)||g.querySelector(p))}),(e=>console.log(e)))}))}}},analytics_ow.personalisation.func.simple_price_teaser_update=(e,t,a,n)=>{let o=`sccs-simple-teaser-tile-with-price[data-aem-targeting-use-case="${e}"]`;t&&""!==t&&(o+=`[data-aem-targeting-vehicle="${t}"]`),a&&""!==a&&(o+=`[data-aem-targeting-use-case-variant="${a}"]`);let i=document.querySelector(o),s=analytics_ow.personalisation.func.getJSONData(i.getAttribute("component-id"))||"{}";if(i?.updateComponentConfigurationPayload)i.updateComponentConfigurationPayload(n.payload);else{var r=Object.assign({},s,n);window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA").then((function(e){e.addPersonalisationData({componentId:i.getAttribute("component-id"),personalisationData:r.payload})}))}i.classList.remove("aem--is-hidden")},analytics_ow.personalisation.func.banner_teaser_update=(e,t,a,n)=>{let o=`owc-banner-teaser[data-aem-targeting-use-case="${e}"]`;t&&(o+=`[data-aem-targeting-vehicle="${t}"]`),a&&(o+=`[data-aem-targeting-use-case-variant="${a}"]`);const i=document.querySelector(o);if(!i)return;const s={...analytics_ow.personalisation.func.getJSONData(i.getAttribute("component-id"))||"{}",...n};window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA").then((e=>{e.addPersonalisationData({componentId:i.getAttribute("component-id"),personalisationData:s}),i.classList.remove("aem--is-hidden")}))},analytics_ow.personalisation.func.textmediamodule_update=(e,t,a,n,o,i,s,r)=>{let l=`owc-text-media-module[data-aem-targeting-use-case="${t}"]`;s&&(l+=`[data-aem-targeting-use-case-variant="${s}"]`),r&&(l+=`[data-aem-targeting-vehicle="${r}"]`);const c=document.querySelector(l);if(e||!c?.personalisation)return c;{const e=analytics_ow.personalisation.func.getJSONData(c.getAttribute("component-id"))||"{}",t={...e,textBlock:{...e.textBlock,headline:a||e.textBlock.headline,description:n||e.textBlock.description,subtitle:o||e.textBlock.subtitle},buttonData:i||e.buttonData};window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA").then((e=>{e.addPersonalisationData({componentId:c.getAttribute("component-id"),personalisationData:t}),c.classList.remove("aem--is-hidden")}))}},analytics_ow.personalisation.func.subNav_update=async e=>{const t=document.querySelector("owc-subnavigation");if(!t)return;const a=analytics_ow.personalisation.func.getJSONData(t.getAttribute("component-id"))||"{}";e.cta={ctaDisplayMethod:"manual"};const n={...a,...e};(await window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA")).addPersonalisationData({componentId:t.getAttribute("component-id"),personalisationData:n})},analytics_ow.personalisation.func.pipage_cta_update=async(e,t)=>{const a=[];document.querySelector('[data-component-name="owpi-dynamic-stage-mvp"]')||document.querySelector(".owpi-dynamic-stage")||a.push("owc-stage");const n=a.map((async e=>{const t=document.querySelector(e);if(null!==t){const e=analytics_ow.personalisation.func.getJSONData(t.getAttribute("component-id"))||"{}";if("manual"===e.cta.ctaDisplayMethod){e.cta={ctaDisplayMethod:"automate"};(await window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA")).addPersonalisationData({componentId:t.getAttribute("component-id"),personalisationData:e})}}}));await Promise.all(n);const o=await window.top.seamlessStore.store.getConnection("OWC_VEHICLE_DATA");let i=setInterval((()=>{window.top.seamlessStore.store.store.getState().OWC_VEHICLE_DATA.cta.primary===e&&window.top.seamlessStore.store.store.getState().OWC_VEHICLE_DATA.cta.secondary===t?clearInterval(i):o.setCta({primary:e,secondary:t})}),250)},analytics_ow.personalisation.func.campaign_module_update=e=>{let t=analytics_ow.personalisation.globalvars.campaign_module||{};t?.update_block||(t.timer&&clearTimeout(t.timer),t.modules=t.modules||[],t.modules.push(e),t.timer=setTimeout((()=>{const e=document.querySelector('[data-component-name="hp-campaigns"]:not([data-aem-targeting-hidden-initially])');if(e){t.modules.sort(((e,t)=>e.prio-t.prio));for(let a=0;a<t.modules.length;a++)if(t.modules[a].image.toLowerCase().includes("pov=")){let n=t.modules[a].image.split("&")[0];t.modules[a].image=0===a?`${n}&IMGT=W27&POV=BE030&BKGND=9&im=Crop,rect=(300,500,1950,1750),gravity=Center;&crop=0,0,2150,1050`:`${n}&IMGT=W27&POV=BE030&BKGND=9&uni=m&imwidth=1650&imheight=2100&Resize,width=1550&crop=150,300,0,478&im=Crop,rect=(200,200,1600,1900)`,(window.innerWidth<1024||document.documentElement.clientWidth<1024||3===e?.querySelectorAll(".wb-grid-col-mq6-4")?.length)&&(t.modules[a].image=`${n}&IMGT=W27&POV=BE030&BKGND=9&uni=m&imwidth=1650&imheight=2100&Resize,width=1550&crop=150,300,0,478&im=Crop,rect=(200,200,1600,1900)`),t.modules[a].personalisationBg=!0}else if(t.modules[a].image.toLowerCase().includes("/bbd/images/"))t.modules[a].personalisationBg=!0;else if(t.modules[a].image.toLowerCase().includes("/dam/hq/personalization/")&&t.modules[a].image.toLowerCase().includes("/16x9/")){const n=analytics_ow.personalisation.func.find_all_by_key(dataLayer_ow,"mediaQuery")[0],o={mq1:"?im=Resize=(433,770)",mq2:"?im=Resize=(721,1282)",mq3:"?im=Resize=(977,1737)",mq4:a>0||3===e?.querySelectorAll(".wb-grid-col-mq6-4")?.length?"?im=Resize=(356,633)":"?im=Resize=(728,409)",mq5:a>0||3===e?.querySelectorAll(".wb-grid-col-mq6-4")?.length?"?im=Resize=(397,705)":"?im=Resize=(817,460)",mq6:a>0||3===e?.querySelectorAll(".wb-grid-col-mq6-4")?.length?"?im=Resize=(539,958)":"?im=Resize=(1109,624)"};(["mq1","mq2","mq3"].includes(n)||3===e?.querySelectorAll(".wb-grid-col-mq6-4")?.length||a>0)&&(t.modules[a].image=t.modules[a].image.replace(/16x9/g,"9x16"));const i=o[n];t.modules[a].image=`${t.modules[a].image}${i}&c=1`}window.top.seamlessStore.store.getConnection("OWC_PERSONALISATION_DATA").then((a=>{a.addPersonalisationData({componentId:e.getAttribute("component-id"),personalisationData:t.modules})})),t.update_block=!0}}),750)),analytics_ow.personalisation.globalvars.campaign_module=t},analytics_ow.personalisation.func.campaign_module_tracking=(e,t,a)=>{let n=!1,o=new MutationObserver((i=>{for(let s of i)if("attributes"===s.type&&(s.target.innerHTML.includes(e.image.split("&")[0])||s.target.getAttribute("src")?.includes(e.image.split("&")[0]))&&!n){let i=s.target.querySelector(`img[src*="${e.image.split("&")[0]}"]`)||s.target;const r=i?.closest(".hp-campaigns__container")?.querySelectorAll("a, .wb-button");if(r){o.disconnect(),window.analytics_ow.personalisation.func.impressionTracking(t,a,"campaignModuleElement_active"),window.analytics_ow.personalisation.func.sendEvergageData(a,t,"Impression");for(let e of r)window.analytics_ow.personalisation.func.clickTracking(e,t,a),window.analytics_ow.personalisation.func.sendEvergageData(a,t,"Clickthrough",e);n=!0}break}})),i=setInterval((function(){const e=document.querySelector('[data-component-name="hp-campaigns"]:not([data-aem-targeting-hidden-initially])').querySelector(".hp-campaigns__items");e&&(clearInterval(i),o.observe(e,{attributes:!0,childList:!0,subtree:!0}))}),50)},analytics_ow.personalisation.func.getVehicleImage=async(e,t,a="none",n="stage",o=!1)=>{const i=await analytics_ow.personalisation.func.getVMDSData_modelspecific(e.toLowerCase(),o);if(!i)return;const s=i[0]?.bodytypes.find((e=>e.bodytypeId==t));if(!s)return!1;const r=s?.models[0]?.vehicles[0].images?.stage;if(!r)return!1;const l={simple_teaser:"&Resize,width=480",banner_teaser:"&Resize,width=960",stage:""}[n]||"";return"default"===a?r+l:"none"===a?r.split("&&BKGND=")[0]:r.split("&&BKGND=")[0]+a+l},analytics_ow.personalisation.func.get_pipage_stageimage=async(e,t)=>{const a=(e,t,a)=>e?.querySelector(t)?.getAttribute(a),n=e===window.location.origin+window.location.pathname?document:await(async e=>{const t=await fetch(e,{cache:"force-cache"}),a=await t.text(),n=document.createElement("div");return n.innerHTML=a,n})(e),o=n.querySelector('[data-component-name="owpi-dynamic-stage-mvp"]'),i=(e=>{const t=e?.querySelector(".owpi-dynamic-stage-mvp__content img"),a=((e,t)=>{const a=e?.getAttribute("style"),n=a?.match(new RegExp(`${t}:\\s*([^;]+);?`,"i"));return n?n[1].trim():null})(e?.querySelector("wb7-360-viewer")?.shadowRoot?.querySelector(".image"),"background-image");return t?.src||a?.split('url("')[1]?.split('"')[0]})(o),s=(r=o?.querySelector(".owpi-stage-bg")?.querySelectorAll("source"),l=window.innerWidth||document.documentElement.clientWidth,Array.from(r||[]).find((e=>l>parseInt(e.getAttribute("media").split("width: ")[1].split("px")[0])))?.getAttribute("srcset"));var r,l;return a(n,'link[media="(min-width: 1440px)"][as="image"]',"href")?a(n,'link[media="(min-width: 1440px)"][as="image"]',"href"):o&&i?t?{vehicle_image:i,vehicle_bg:s}:i:o&&!i?a(n,'[property="og:image"]',"content"):!!n.querySelector("owc-stage")&&"/content/dam/"+n.querySelector("owc-stage script").textContent.split("/content/dam/")[1].split('"')[0].split("?")[0]},analytics_ow.personalisation.func.getJSONData=e=>(window.top.seamlessStore.store.subscribe("OWC_COMPONENT_REGISTRY",(({components:t})=>data=t[e])),data),analytics_ow.personalisation.func.getAffinityScoreData=()=>window.top.seamlessStore.store.store.getState().AFFINITY_SCORE,analytics_ow.personalisation.func.loadTemplateScript=async(e,t)=>{const a=document.createElement("script"),n=t?`/vans/${e}.js`:`/${e}.js`;return a.src=`https://assets.oneweb.mercedes-benz.com/plugin/ats-personalization/latest/template_codes_min${n}`,new Promise(((t,n)=>{a.onload=()=>t(!0),a.onerror=()=>n(new Error(`Script load error for ${e}`)),document.head.append(a)}))},analytics_ow.personalisation.func.setTrackingObject=(e,t,a)=>(a.type=e.Type,a.campaign=e.Campaign,a.experience=t,a.vehicle=e.Vehicle,a.trigger=e.Trigger,a),analytics_ow.personalisation.func.init_stage_buttons=(e,t)=>{const a=document.querySelector(".owpi-sales-bar__ctas, .owpi-dynamic-stage-mvp, owc-stage:not([data-aem-targeting-hidden-initially])");(a?.shadowRoot?.querySelector(".owc-stage")||a).querySelectorAll("a,.wb-button,.wbx-button, .owc-stage-cta-buttons__button").forEach((a=>{window.analytics_ow.personalisation.func.clickTracking(a,t,e),window.analytics_ow.personalisation.func.sendEvergageData(e,t,"Clickthrough",a)}))},analytics_ow.personalisation.func.init_simple_teaser_buttons=(e,t,a)=>{a.shadowRoot.querySelector(".owc-simple-teaser-item").querySelectorAll("a").forEach((a=>{window.analytics_ow.personalisation.func.clickTracking(a,t,e),window.analytics_ow.personalisation.func.sendEvergageData(e,t,"Clickthrough",a)}))},analytics_ow.personalisation.func.pi_page_save_visit=(e,t)=>{const a=window.location.href,n=e,o=t,i="target_vehicle_pi_page";let s={vehiclePI:a,vehicleCode:n,vehicleBM:o,vehiclePIHistory:window.location.pathname.includes("/vans/")?n:o};const r=window.localStorage.getItem(i);if(r){const e=JSON.parse(r);e?.vehiclePIHistory&&(e.vehiclePIHistory.includes(o)||e.vehiclePIHistory.includes(n)||(s.vehiclePIHistory=window.location.pathname.includes("/vans/")?`${e.vehiclePIHistory},${n}`:`${e.vehiclePIHistory},${o}`))}a.includes("finance.html")||setTimeout((()=>{window.analytics_ow.personalisation.func.localStorage_set(i,s),Evergage.sendEvent({action:"set_user_attribute",account:{attributes:{lastPiPage:s}}})}),3e3)},analytics_ow.personalisation.func.template_debugger=()=>{Object.entries(window.analytics_ow.personalisation.templatecodes).forEach((function(e){console.log("Debug template:",e[0]),window.analytics_ow.personalisation.templatecodes[e[0]].debug()}))},analytics_ow.personalisation.func.vans_modelseries_mapping=e=>{let t=[{currentModelSeries:"4206-XZ0",newModelSeries:"P420"},{currentModelSeries:"4206-XZ0-I0E",newModelSeries:"I420"},{currentModelSeries:"4207-XZ0",newModelSeries:"T420"},{currentModelSeries:"4207-XZ0-I0E",newModelSeries:"F420"},{currentModelSeries:"4208-XZ0",newModelSeries:"V420"},{currentModelSeries:"4208-XZ0-I0E",newModelSeries:"E420"},{currentModelSeries:"4476-XZ2-fl",newModelSeries:"P447-fl2"},{currentModelSeries:"4476-XZ2-M8E-fl",newModelSeries:"I447-fl2"},{currentModelSeries:"4477-XZ2-fl",newModelSeries:"T447-fl2"},{currentModelSeries:"4477-XZ2-ME4-fl",newModelSeries:"F447-fl2"},{currentModelSeries:"4477-XZ2-ZK4-fl",newModelSeries:"M447-fl2"},{currentModelSeries:"4478-XZ1",newModelSeries:"V447-fl"},{currentModelSeries:"4478-XZ1-fl",newModelSeries:"V447-fl"},{currentModelSeries:"4478-XZ1-ME4",newModelSeries:"E447-fl"},{currentModelSeries:"4478-XZ1-ZK7",newModelSeries:"R447-fl"},{currentModelSeries:"4478-XZ2-fl",newModelSeries:"V447-fl2"},{currentModelSeries:"4478-XZ2-ME4-fl",newModelSeries:"E447-fl2"},{currentModelSeries:"4478-XZ2-ZK7-fl",newModelSeries:"R447-fl2"},{currentModelSeries:"9071-XZ0",newModelSeries:"C907"},{currentModelSeries:"9071-XZ0-P02",newModelSeries:"C907-P02"},{currentModelSeries:"9071-XZ0-ZZ0",newModelSeries:"P907-ZZ0"},{currentModelSeries:"9071-XZ0-ZZZ",newModelSeries:"P907-ZZZ"},{currentModelSeries:"9071-XZ1-fl",newModelSeries:"C907-fl"},{currentModelSeries:"9071-XZ1-M1E-fl",newModelSeries:"K907-fl"},{currentModelSeries:"9071-XZ1-P02",newModelSeries:"C907-fl-P02"},{currentModelSeries:"9072-XZ1-fl",newModelSeries:"D907-fl"},{currentModelSeries:"9076-XZ0",newModelSeries:"P907"},{currentModelSeries:"9076-XZ0-ZZ1",newModelSeries:"T907-ZZ1"},{currentModelSeries:"9076-XZ0-ZZZ",newModelSeries:"T907-ZZZ"},{currentModelSeries:"9076-XZ0-ZZZ-fl",newModelSeries:"T907-ZZZ"},{currentModelSeries:"9076-XZ1-fl",newModelSeries:"P907-fl"},{currentModelSeries:"9076-XZ1-M1E-fl",newModelSeries:"I907-fl"},{currentModelSeries:"9077-XZ1-fl",newModelSeries:"T907-fl"},{currentModelSeries:"9078-XZ1",newModelSeries:"B907-fl"},{currentModelSeries:"9101-XZ1-fl",newModelSeries:"C910-fl"}].find((t=>t.currentModelSeries===e||t.newModelSeries===e));return t||null},analytics_ow.personalisation.template=class{constructor({tracking_object:e,target:t,control:a,experience_specific_methods:n,experience_specific_vars:o,track_on_init:i,dependancies:s={}}){this.tracking_object=e,this.experience_specific_methods=n,this.experience_specific_vars=o,this.dependancies=s;var r=this;this.debug=function(){var e={};Object.entries(r.dependancies).forEach((t=>{if("options"==t[0])for(var a=0;a<t[1].length;a++){var n=Object.entries(t[1][a]),o="OPT_",i={exp:"",val:"",pass:""};n.forEach(((e,t)=>{var a=t==n.length-1,s=e[0];o+=a?s:s+"_OR_",i.exp+=a?e[1]?.exp:e[1]?.exp+",",i.val+=a?e[1]?.val:e[1]?.val+",",i.pass+=a?e[1]?.exp==e[1]?.val:(e[1]?.exp==e[1]?.val)+","})),e[o]=i}else{var s=t[0];e[s]={exp:t[1].exp,val:t[1].val,pass:t[1].exp==t[1].val}}})),console.table(e)},this.add_deps=function(e){return e.length>0?(r.dependancies.options=r.dependancies.options||[],r.dependancies.options.push(e[0])):r.dependancies={...r.dependancies,...e},r.dependancies},this.target=function(a,s,r,l,c){void 0===window.analytics_ow.personalisation.globalvars.firedCampaign[this.tracking_object.campaign]&&(window.analytics_ow.personalisation.globalvars.firedCampaign[this.tracking_object.campaign]=!0,i&&(window.analytics_ow.personalisation.func.impressionTracking(this.tracking_object,a,this.tracking_object.format+"_active"),window.analytics_ow.personalisation.func.sendEvergageData(a,this.tracking_object,"Impression")),t(a,n,o,e,this.add_deps))},this.control=function(t,s,r,l,c){void 0===window.analytics_ow.personalisation.globalvars.firedCampaign[this.tracking_object.campaign]&&(window.analytics_ow.personalisation.globalvars.firedCampaign[this.tracking_object.campaign]=!0,this.tracking_object.experience="control",i&&(window.analytics_ow.personalisation.func.impressionTracking(this.tracking_object,t,this.tracking_object.format+"_active"),window.analytics_ow.personalisation.func.sendEvergageData(t,this.tracking_object,"Impression")),a(t,n,o,e,this.add_deps))}}},setTimeout((function(){analytics_ow.personalisation.func.setLocales(),analytics_ow.personalisation.func.setVehicleInformation()}),500),analytics_ow.personalisation.func.setLocales(),analytics_ow.personalisation.func.localStorage_check(),analytics_ow.personalisation.func.check_storages();